import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,a as l,o as p}from"./app-BWBc4D8a.js";const e={};function o(F,s){return p(),a("div",null,s[0]||(s[0]=[l(`<h1 id="优化技巧" tabindex="-1"><a class="header-anchor" href="#优化技巧"><span>优化技巧</span></a></h1><h2 id="查看top-sql" tabindex="-1"><a class="header-anchor" href="#查看top-sql"><span>查看TOP SQL</span></a></h2><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="background-color:#272822;color:#F8F8F2;"><pre class="shiki monokai vp-code"><code><span class="line"><span style="color:#F92672;">WITH</span><span style="color:#F8F8F2;"> w1 </span><span style="color:#F92672;">AS</span></span>
<span class="line"><span style="color:#F8F8F2;"> (</span><span style="color:#F92672;">SELECT</span><span style="color:#AE81FF;"> sst</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">snap_id</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">         to_char(</span><span style="color:#AE81FF;">sst</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">begin_interval_time</span><span style="color:#F8F8F2;">, </span><span style="color:#E6DB74;">&#39;yyyy-mm-dd hh24:mi:ss&#39;</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">AS</span><span style="color:#F8F8F2;"> begin_date,</span></span>
<span class="line"><span style="color:#F8F8F2;">         to_char(</span><span style="color:#AE81FF;">sst</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">end_interval_time</span><span style="color:#F8F8F2;">, </span><span style="color:#E6DB74;">&#39;yyyy-mm-dd hh24:mi:ss&#39;</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">AS</span><span style="color:#F8F8F2;"> end_date,</span></span>
<span class="line"><span style="color:#AE81FF;">         s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">executions_delta</span><span style="color:#F92672;"> AS</span><span style="color:#F8F8F2;"> executions,         </span></span>
<span class="line"><span style="color:#66D9EF;">         round</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">rows_processed_delta</span><span style="color:#F92672;"> /</span></span>
<span class="line"><span style="color:#F8F8F2;">               decode(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">executions_delta</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">executions_delta</span><span style="color:#F8F8F2;">),</span></span>
<span class="line"><span style="color:#AE81FF;">               2</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">AS</span><span style="color:#F8F8F2;"> rows_per,</span></span>
<span class="line"><span style="color:#66D9EF;">         round</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">elapsed_time_delta</span><span style="color:#F92672;"> /</span><span style="color:#AE81FF;"> 1000000</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">2</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">AS</span><span style="color:#F8F8F2;"> elapsed_time,</span></span>
<span class="line"><span style="color:#66D9EF;">         round</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">elapsed_time_delta</span><span style="color:#F92672;"> /</span><span style="color:#AE81FF;"> 1000000</span><span style="color:#F92672;"> /</span></span>
<span class="line"><span style="color:#F8F8F2;">               decode(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">executions_delta</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">executions_delta</span><span style="color:#F8F8F2;">),</span></span>
<span class="line"><span style="color:#AE81FF;">               2</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">AS</span><span style="color:#F8F8F2;"> elapsed_time_per,</span></span>
<span class="line"><span style="color:#66D9EF;">         round</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">cpu_time_delta</span><span style="color:#F92672;"> /</span></span>
<span class="line"><span style="color:#F8F8F2;">               decode(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">elapsed_time_delta</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">elapsed_time_delta</span><span style="color:#F8F8F2;">),</span></span>
<span class="line"><span style="color:#AE81FF;">               2</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">AS</span><span style="color:#E6DB74;"> &quot;CPU%&quot;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#66D9EF;">         round</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">iowait_delta</span><span style="color:#F92672;"> /</span></span>
<span class="line"><span style="color:#F8F8F2;">               decode(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">elapsed_time_delta</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">elapsed_time_delta</span><span style="color:#F8F8F2;">),</span></span>
<span class="line"><span style="color:#AE81FF;">               2</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">AS</span><span style="color:#E6DB74;"> &quot;IO%&quot;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#AE81FF;">         s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">sql_id</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#66D9EF;">         round</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">cpu_time_delta</span><span style="color:#F92672;"> /</span><span style="color:#AE81FF;"> 1000000</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">AS</span><span style="color:#F8F8F2;"> cpu_time,</span></span>
<span class="line"><span style="color:#66D9EF;">         round</span><span style="color:#F8F8F2;">(</span><span style="color:#66D9EF;">round</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">cpu_time_delta</span><span style="color:#F92672;"> /</span><span style="color:#AE81FF;"> 1000000</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">/</span></span>
<span class="line"><span style="color:#F8F8F2;">               decode(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">executions_delta</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">executions_delta</span><span style="color:#F8F8F2;">)) </span><span style="color:#F92672;">AS</span><span style="color:#F8F8F2;"> cpu_time_per,</span></span>
<span class="line"><span style="color:#66D9EF;">         round</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">iowait_delta</span><span style="color:#F92672;"> /</span><span style="color:#AE81FF;"> 1000000</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">AS</span><span style="color:#F8F8F2;"> user_io_wait_time,</span></span>
<span class="line"><span style="color:#66D9EF;">         round</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">iowait_delta</span><span style="color:#F92672;"> /</span><span style="color:#AE81FF;"> 1000000</span><span style="color:#F92672;"> /</span></span>
<span class="line"><span style="color:#F8F8F2;">               decode(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">executions_delta</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">executions_delta</span><span style="color:#F8F8F2;">),</span></span>
<span class="line"><span style="color:#AE81FF;">               2</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">AS</span><span style="color:#F8F8F2;"> user_io_wait_time_per,</span></span>
<span class="line"><span style="color:#AE81FF;">         s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">buffer_gets_delta</span><span style="color:#F92672;"> AS</span><span style="color:#F8F8F2;"> buffer_gets,</span></span>
<span class="line"><span style="color:#66D9EF;">         round</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">buffer_gets_delta</span><span style="color:#F92672;"> /</span></span>
<span class="line"><span style="color:#F8F8F2;">               decode(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">executions_delta</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">executions_delta</span><span style="color:#F8F8F2;">)) </span><span style="color:#F92672;">AS</span><span style="color:#F8F8F2;"> buffer_gets_per,</span></span>
<span class="line"><span style="color:#AE81FF;">         s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">disk_reads_delta</span><span style="color:#F92672;"> AS</span><span style="color:#F8F8F2;"> disk_reads,</span></span>
<span class="line"><span style="color:#66D9EF;">         round</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">disk_reads_delta</span><span style="color:#F92672;"> /</span></span>
<span class="line"><span style="color:#F8F8F2;">               decode(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">executions_delta</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">executions_delta</span><span style="color:#F8F8F2;">)) </span><span style="color:#F92672;">AS</span><span style="color:#F8F8F2;"> disk_reads_per,</span></span>
<span class="line"><span style="color:#AE81FF;">         s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">parse_calls_delta</span><span style="color:#F92672;"> AS</span><span style="color:#F8F8F2;"> parse_calls,</span></span>
<span class="line"><span style="color:#66D9EF;">         round</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">parse_calls_delta</span><span style="color:#F92672;"> /</span></span>
<span class="line"><span style="color:#F8F8F2;">               decode(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">executions_delta</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">executions_delta</span><span style="color:#F8F8F2;">)) </span><span style="color:#F92672;">AS</span><span style="color:#F8F8F2;"> parse_calls_per,</span></span>
<span class="line"><span style="color:#AE81FF;">         s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">sharable_mem</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#66D9EF;">         round</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">sharable_mem</span><span style="color:#F92672;"> /</span></span>
<span class="line"><span style="color:#F8F8F2;">               decode(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">executions_delta</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">executions_delta</span><span style="color:#F8F8F2;">)) </span><span style="color:#F92672;">AS</span><span style="color:#F8F8F2;"> sharable_mem_per</span></span>
<span class="line"><span style="color:#F92672;">    FROM</span><span style="color:#AE81FF;"> sys</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">dba_hist_snapshot</span><span style="color:#F8F8F2;"> sst, dba_hist_sqlstat s</span></span>
<span class="line"><span style="color:#F92672;">   WHERE</span><span style="color:#AE81FF;"> sst</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">dbid</span><span style="color:#F92672;"> =</span><span style="color:#AE81FF;"> s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">dbid</span></span>
<span class="line"><span style="color:#F92672;">     AND</span><span style="color:#AE81FF;"> sst</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">snap_id</span><span style="color:#F92672;"> =</span><span style="color:#AE81FF;"> s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">snap_id</span></span>
<span class="line"><span style="color:#F92672;">     AND</span><span style="color:#AE81FF;"> sst</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">instance_number</span><span style="color:#F92672;"> =</span><span style="color:#AE81FF;"> s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">instance_number</span></span>
<span class="line"><span style="color:#F92672;">     AND</span><span style="color:#AE81FF;"> sst</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">begin_interval_time</span><span style="color:#F92672;"> &gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">         to_date(</span><span style="color:#E6DB74;">&#39;2023-04-13 14:00:00&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#E6DB74;">&#39;yyyy-mm-dd hh24:mi:ss&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F92672;">     AND</span><span style="color:#AE81FF;"> sst</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">end_interval_time</span><span style="color:#F92672;"> &lt;</span></span>
<span class="line"><span style="color:#F8F8F2;">         to_date(</span><span style="color:#E6DB74;">&#39;2023-04-13 16:00:00&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#E6DB74;">&#39;yyyy-mm-dd hh24:mi:ss&#39;</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">+</span><span style="color:#AE81FF;"> 1</span><span style="color:#F92672;"> /</span><span style="color:#AE81FF;"> 24</span><span style="color:#F92672;"> /</span><span style="color:#AE81FF;"> 60</span></span>
<span class="line"><span style="color:#F92672;">   ORDER BY</span><span style="color:#F8F8F2;"> nvl(</span><span style="color:#AE81FF;">s</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">elapsed_time_delta</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">DESC</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F92672;">SELECT</span><span style="color:#F92672;"> *</span><span style="color:#F92672;"> FROM</span><span style="color:#F8F8F2;"> w1 </span><span style="color:#F92672;">WHERE</span><span style="color:#F8F8F2;"> rownum </span><span style="color:#F92672;">&lt;=</span><span style="color:#AE81FF;"> 10</span><span style="color:#F8F8F2;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="计算表的行数" tabindex="-1"><a class="header-anchor" href="#计算表的行数"><span>计算表的行数</span></a></h2><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="background-color:#272822;color:#F8F8F2;"><pre class="shiki monokai vp-code"><code><span class="line"><span style="color:#88846F;">---------------------------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#88846F;">--全表扫描，从磁盘读取（直接路径读）</span></span>
<span class="line"><span style="color:#F92672;">SELECT</span><span style="color:#AE81FF;"> odbs_performance_snap_util</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">start_snap_sql_simple</span><span style="color:#F8F8F2;">(i_task_name </span><span style="color:#F92672;">=&gt;</span><span style="color:#E6DB74;"> &#39;test230517m1&#39;</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">FROM</span><span style="color:#F8F8F2;"> dual;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">--alter session set &quot;_serial_direct_read&quot;=never; </span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">alter</span><span style="color:#F92672;"> session</span><span style="color:#F92672;"> set</span><span style="color:#E6DB74;"> &quot;_serial_direct_read&quot;</span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;">true; </span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">SELECT</span><span style="color:#88846F;"> /*test230517m1*/</span><span style="color:#88846F;"> /*+ full(t) */</span><span style="color:#66D9EF;"> COUNT</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">FROM</span><span style="color:#F8F8F2;"> big_table_line2 t;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">SELECT</span><span style="color:#AE81FF;"> odbs_performance_snap_util</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">end_snap_sql_simple</span><span style="color:#F92672;"> FROM</span><span style="color:#F8F8F2;"> dual;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">---------------------------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#88846F;">--全表扫描，从内存读取</span></span>
<span class="line"><span style="color:#F92672;">SELECT</span><span style="color:#AE81FF;"> odbs_performance_snap_util</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">start_snap_sql_simple</span><span style="color:#F8F8F2;">(i_task_name </span><span style="color:#F92672;">=&gt;</span><span style="color:#E6DB74;"> &#39;test230517n1&#39;</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">FROM</span><span style="color:#F8F8F2;"> dual;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">alter</span><span style="color:#F92672;"> session</span><span style="color:#F92672;"> set</span><span style="color:#E6DB74;"> &quot;_serial_direct_read&quot;</span><span style="color:#F92672;">=never</span><span style="color:#F8F8F2;">; </span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">--alter session set &quot;_serial_direct_read&quot;=true; </span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">SELECT</span><span style="color:#88846F;"> /*test230517n1*/</span><span style="color:#88846F;"> /*+ full(t) */</span><span style="color:#66D9EF;"> COUNT</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">FROM</span><span style="color:#F8F8F2;"> big_table_line2 t;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">SELECT</span><span style="color:#AE81FF;"> odbs_performance_snap_util</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">end_snap_sql_simple</span><span style="color:#F92672;"> FROM</span><span style="color:#F8F8F2;"> dual;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">---------------------------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#88846F;">--全表扫描+并行，从磁盘读取</span></span>
<span class="line"><span style="color:#F92672;">SELECT</span><span style="color:#AE81FF;"> odbs_performance_snap_util</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">start_snap_sql_simple</span><span style="color:#F8F8F2;">(i_task_name </span><span style="color:#F92672;">=&gt;</span><span style="color:#E6DB74;"> &#39;test230517o1&#39;</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">FROM</span><span style="color:#F8F8F2;"> dual;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">--alter session set &quot;_serial_direct_read&quot;=never; </span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">alter</span><span style="color:#F92672;"> session</span><span style="color:#F92672;"> set</span><span style="color:#E6DB74;"> &quot;_serial_direct_read&quot;</span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;">true; </span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">SELECT</span><span style="color:#88846F;"> /*test230517o1*/</span><span style="color:#88846F;"> /*+ parallel(8) full(t) */</span><span style="color:#66D9EF;"> COUNT</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">FROM</span><span style="color:#F8F8F2;"> big_table_line2 t;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">SELECT</span><span style="color:#AE81FF;"> odbs_performance_snap_util</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">end_snap_sql_simple</span><span style="color:#F92672;"> FROM</span><span style="color:#F8F8F2;"> dual;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">---------------------------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#88846F;">--全索引扫描，从磁盘读取</span></span>
<span class="line"><span style="color:#F92672;">SELECT</span><span style="color:#AE81FF;"> odbs_performance_snap_util</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">start_snap_sql_simple</span><span style="color:#F8F8F2;">(i_task_name </span><span style="color:#F92672;">=&gt;</span><span style="color:#E6DB74;"> &#39;test230517p1&#39;</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">FROM</span><span style="color:#F8F8F2;"> dual;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">--alter session set &quot;_serial_direct_read&quot;=never; </span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">alter</span><span style="color:#F92672;"> session</span><span style="color:#F92672;"> set</span><span style="color:#E6DB74;"> &quot;_serial_direct_read&quot;</span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;">true; </span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">SELECT</span><span style="color:#88846F;"> /*test230517p1*/</span><span style="color:#88846F;"> /*+ parallel(1) index_ffs(t big_table_line2_pk) */</span><span style="color:#66D9EF;"> COUNT</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">FROM</span><span style="color:#F8F8F2;"> big_table_line2 t;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">SELECT</span><span style="color:#AE81FF;"> odbs_performance_snap_util</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">end_snap_sql_simple</span><span style="color:#F92672;"> FROM</span><span style="color:#F8F8F2;"> dual;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">---------------------------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#88846F;">--全索引扫描，从内存读取</span></span>
<span class="line"><span style="color:#F92672;">SELECT</span><span style="color:#AE81FF;"> odbs_performance_snap_util</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">start_snap_sql_simple</span><span style="color:#F8F8F2;">(i_task_name </span><span style="color:#F92672;">=&gt;</span><span style="color:#E6DB74;"> &#39;test230517q1&#39;</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">FROM</span><span style="color:#F8F8F2;"> dual;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">--alter session set &quot;_serial_direct_read&quot;=never; </span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">alter</span><span style="color:#F92672;"> session</span><span style="color:#F92672;"> set</span><span style="color:#E6DB74;"> &quot;_serial_direct_read&quot;</span><span style="color:#F92672;">=never</span><span style="color:#F8F8F2;">; </span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">SELECT</span><span style="color:#88846F;"> /*test230517q1*/</span><span style="color:#88846F;"> /*+ parallel(1) index_ffs(t big_table_line2_pk) */</span><span style="color:#66D9EF;"> COUNT</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">FROM</span><span style="color:#F8F8F2;"> big_table_line2 t;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">SELECT</span><span style="color:#AE81FF;"> odbs_performance_snap_util</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">end_snap_sql_simple</span><span style="color:#F92672;"> FROM</span><span style="color:#F8F8F2;"> dual;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">---------------------------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#88846F;">--全索引扫描+并行，从磁盘读取</span></span>
<span class="line"><span style="color:#F92672;">SELECT</span><span style="color:#AE81FF;"> odbs_performance_snap_util</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">start_snap_sql_simple</span><span style="color:#F8F8F2;">(i_task_name </span><span style="color:#F92672;">=&gt;</span><span style="color:#E6DB74;"> &#39;test230517r1&#39;</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">FROM</span><span style="color:#F8F8F2;"> dual;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">--alter session set &quot;_serial_direct_read&quot;=never; </span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">alter</span><span style="color:#F92672;"> session</span><span style="color:#F92672;"> set</span><span style="color:#E6DB74;"> &quot;_serial_direct_read&quot;</span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;">true; </span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">SELECT</span><span style="color:#88846F;"> /*test230517r1*/</span><span style="color:#88846F;"> /*+ parallel(8) index_ffs(t big_table_line2_n1) */</span><span style="color:#66D9EF;"> COUNT</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">FROM</span><span style="color:#F8F8F2;"> big_table_line2 t </span><span style="color:#F92672;">WHERE</span><span style="color:#AE81FF;"> t</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">parent_id</span><span style="color:#F92672;"> IS NOT NULL</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F92672;">SELECT</span><span style="color:#AE81FF;"> odbs_performance_snap_util</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">end_snap_sql_simple</span><span style="color:#F92672;"> FROM</span><span style="color:#F8F8F2;"> dual;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5)]))}const t=n(e,[["render",o]]),i=JSON.parse('{"path":"/databases/oracle/Optimizing.html","title":"优化技巧","lang":"zh-CN","frontmatter":{},"git":{},"readingTime":{"minutes":0.1,"words":31},"filePathRelative":"databases/oracle/Optimizing.md"}');export{t as comp,i as data};

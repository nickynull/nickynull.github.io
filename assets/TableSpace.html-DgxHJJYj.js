<<<<<<<< HEAD:assets/TableSpace.html-8Rw_Zxr2.js
import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as n,a as l,o as p}from"./app-DlwGI9O7.js";const o={};function F(e,s){return p(),n("div",null,s[0]||(s[0]=[l(`<h1 id="表空间" tabindex="-1"><a class="header-anchor" href="#表空间"><span>表空间</span></a></h1><h2 id="查看表空间使用情况" tabindex="-1"><a class="header-anchor" href="#查看表空间使用情况"><span>查看表空间使用情况</span></a></h2><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="background-color:#272822;color:#F8F8F2;"><pre class="shiki monokai vp-code"><code><span class="line"><span style="color:#F92672;">WITH</span><span style="color:#F8F8F2;"> w1 </span><span style="color:#F92672;">AS</span></span>
========
import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as n,a as l,o as p}from"./app-C20ZVO3i.js";const o={};function F(e,s){return p(),n("div",null,s[0]||(s[0]=[l(`<h1 id="表空间" tabindex="-1"><a class="header-anchor" href="#表空间"><span>表空间</span></a></h1><h2 id="查看表空间使用情况" tabindex="-1"><a class="header-anchor" href="#查看表空间使用情况"><span>查看表空间使用情况</span></a></h2><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="background-color:#272822;color:#F8F8F2;"><pre class="shiki monokai vp-code"><code><span class="line"><span style="color:#F92672;">WITH</span><span style="color:#F8F8F2;"> w1 </span><span style="color:#F92672;">AS</span></span>
>>>>>>>> 6cd3211d05d11011eb0e4dc888b450bdb21f3602:assets/TableSpace.html-DgxHJJYj.js
<span class="line"><span style="color:#F8F8F2;"> (</span><span style="color:#F92672;">SELECT</span><span style="color:#AE81FF;"> b</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">file_id</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#AE81FF;">         b</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">tablespace_name</span><span style="color:#F8F8F2;"> tbs,</span></span>
<span class="line"><span style="color:#AE81FF;">         b</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">file_name</span><span style="color:#F92672;"> NAME</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#66D9EF;">         round</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">b</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">bytes</span><span style="color:#F92672;"> /</span><span style="color:#AE81FF;"> 1024</span><span style="color:#F92672;"> /</span><span style="color:#AE81FF;"> 1024</span><span style="color:#F92672;"> /</span><span style="color:#AE81FF;"> 1024</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">2</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">AS</span><span style="color:#F8F8F2;"> total_g,</span></span>
<span class="line"><span style="color:#88846F;">         --round(decode(b.maxbytes,0,b.bytes,b.maxbytes) / 1024 / 1024 / 1024, 2) AS max_total_g,</span></span>
<span class="line"><span style="color:#66D9EF;">         round</span><span style="color:#F8F8F2;">(</span><span style="color:#66D9EF;">greatest</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">b</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">maxbytes</span><span style="color:#F8F8F2;">,</span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">,</span><span style="color:#AE81FF;">b</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">bytes</span><span style="color:#F8F8F2;">,</span><span style="color:#AE81FF;">b</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">maxbytes</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">/</span><span style="color:#AE81FF;"> 1024</span><span style="color:#F92672;"> /</span><span style="color:#AE81FF;"> 1024</span><span style="color:#F92672;"> /</span><span style="color:#AE81FF;"> 1024</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">2</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">AS</span><span style="color:#F8F8F2;"> max_total_g,</span></span>
<span class="line"><span style="color:#66D9EF;">         round</span><span style="color:#F8F8F2;">((</span><span style="color:#AE81FF;">b</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">bytes</span><span style="color:#F92672;"> -</span></span>
<span class="line"><span style="color:#F8F8F2;">               decode(</span><span style="color:#66D9EF;">SUM</span><span style="color:#F8F8F2;">(nvl(</span><span style="color:#AE81FF;">a</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">bytes</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">)), </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#66D9EF;">SUM</span><span style="color:#F8F8F2;">(nvl(</span><span style="color:#AE81FF;">a</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">bytes</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">)))) </span><span style="color:#F92672;">/</span><span style="color:#AE81FF;"> 1024</span><span style="color:#F92672;"> /</span><span style="color:#AE81FF;"> 1024</span><span style="color:#F92672;"> /</span><span style="color:#AE81FF;"> 1024</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#AE81FF;">               2</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">AS</span><span style="color:#F8F8F2;"> used_g,</span></span>
<span class="line"><span style="color:#66D9EF;">         round</span><span style="color:#F8F8F2;">(</span><span style="color:#66D9EF;">SUM</span><span style="color:#F8F8F2;">(nvl(</span><span style="color:#AE81FF;">a</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">bytes</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">)) </span><span style="color:#F92672;">/</span><span style="color:#AE81FF;"> 1024</span><span style="color:#F92672;"> /</span><span style="color:#AE81FF;"> 1024</span><span style="color:#F92672;"> /</span><span style="color:#AE81FF;"> 1024</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">2</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">AS</span><span style="color:#F8F8F2;"> remained_g</span></span>
<span class="line"><span style="color:#F92672;">    FROM</span><span style="color:#F8F8F2;"> dba_free_space a, dba_data_files b</span></span>
<span class="line"><span style="color:#F92672;">   WHERE</span><span style="color:#AE81FF;"> a</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">file_id</span><span style="color:#F8F8F2;">(</span><span style="color:#F92672;">+</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">=</span><span style="color:#AE81FF;"> b</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">file_id</span></span>
<span class="line"><span style="color:#F92672;">   GROUP BY</span><span style="color:#AE81FF;"> b</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">file_id</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">b</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">tablespace_name</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">b</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">file_name</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">b</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">bytes</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">b</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">maxbytes</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F92672;">SELECT</span><span style="color:#AE81FF;"> w1</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">tbs</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#66D9EF;">       SUM</span><span style="color:#F8F8F2;">(total_g) </span><span style="color:#F92672;">AS</span><span style="color:#F8F8F2;"> total_g,</span></span>
<span class="line"><span style="color:#66D9EF;">       SUM</span><span style="color:#F8F8F2;">(max_total_g) </span><span style="color:#F92672;">AS</span><span style="color:#F8F8F2;"> max_total_g,</span></span>
<span class="line"><span style="color:#66D9EF;">       SUM</span><span style="color:#F8F8F2;">(used_g) </span><span style="color:#F92672;">AS</span><span style="color:#F8F8F2;"> used_g,</span></span>
<span class="line"><span style="color:#66D9EF;">       SUM</span><span style="color:#F8F8F2;">(remained_g) </span><span style="color:#F92672;">AS</span><span style="color:#F8F8F2;"> remained_g,</span></span>
<span class="line"><span style="color:#66D9EF;">       round</span><span style="color:#F8F8F2;">(</span><span style="color:#66D9EF;">SUM</span><span style="color:#F8F8F2;">(used_g) </span><span style="color:#F92672;">/</span><span style="color:#F8F8F2;"> decode(</span><span style="color:#66D9EF;">SUM</span><span style="color:#F8F8F2;">(total_g), </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#66D9EF;">SUM</span><span style="color:#F8F8F2;">(total_g)) </span><span style="color:#F92672;">*</span><span style="color:#AE81FF;"> 100</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#AE81FF;">             2</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">||</span><span style="color:#E6DB74;"> &#39;%&#39;</span><span style="color:#F92672;"> AS</span><span style="color:#F8F8F2;"> used_rate,</span></span>
<span class="line"><span style="color:#66D9EF;">       round</span><span style="color:#F8F8F2;">(</span><span style="color:#66D9EF;">SUM</span><span style="color:#F8F8F2;">(remained_g) </span><span style="color:#F92672;">/</span><span style="color:#F8F8F2;"> decode(</span><span style="color:#66D9EF;">SUM</span><span style="color:#F8F8F2;">(total_g), </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#66D9EF;">SUM</span><span style="color:#F8F8F2;">(total_g)) </span><span style="color:#F92672;">*</span><span style="color:#AE81FF;"> 100</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#AE81FF;">             2</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">||</span><span style="color:#E6DB74;"> &#39;%&#39;</span><span style="color:#F92672;"> AS</span><span style="color:#F8F8F2;"> remained_rate,</span></span>
<span class="line"><span style="color:#F8F8F2;">       (</span><span style="color:#F92672;">CASE</span></span>
<span class="line"><span style="color:#F92672;">         WHEN</span><span style="color:#66D9EF;"> SUM</span><span style="color:#F8F8F2;">(max_total_g) </span><span style="color:#F92672;">&lt;&gt;</span><span style="color:#AE81FF;"> 0</span><span style="color:#F92672;"> THEN</span></span>
<span class="line"><span style="color:#66D9EF;">          round</span><span style="color:#F8F8F2;">(</span><span style="color:#66D9EF;">SUM</span><span style="color:#F8F8F2;">(used_g) </span><span style="color:#F92672;">/</span></span>
<span class="line"><span style="color:#F8F8F2;">                decode(</span><span style="color:#66D9EF;">SUM</span><span style="color:#F8F8F2;">(max_total_g), </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#66D9EF;">SUM</span><span style="color:#F8F8F2;">(max_total_g)) </span><span style="color:#F92672;">*</span><span style="color:#AE81FF;"> 100</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#AE81FF;">                2</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">||</span><span style="color:#E6DB74;"> &#39;%&#39;</span></span>
<span class="line"><span style="color:#F92672;">         ELSE</span></span>
<span class="line"><span style="color:#E6DB74;">          &#39;-&#39;</span></span>
<span class="line"><span style="color:#F92672;">       END</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">AS</span><span style="color:#F8F8F2;"> max_used_rate,</span></span>
<span class="line"><span style="color:#F8F8F2;">       (</span><span style="color:#F92672;">CASE</span></span>
<span class="line"><span style="color:#F92672;">         WHEN</span><span style="color:#66D9EF;"> SUM</span><span style="color:#F8F8F2;">(max_total_g) </span><span style="color:#F92672;">&lt;&gt;</span><span style="color:#AE81FF;"> 0</span><span style="color:#F92672;"> THEN</span></span>
<span class="line"><span style="color:#66D9EF;">          round</span><span style="color:#F8F8F2;">((</span><span style="color:#66D9EF;">SUM</span><span style="color:#F8F8F2;">(max_total_g) </span><span style="color:#F92672;">-</span><span style="color:#66D9EF;"> SUM</span><span style="color:#F8F8F2;">(used_g)) </span><span style="color:#F92672;">/</span></span>
<span class="line"><span style="color:#F8F8F2;">                decode(</span><span style="color:#66D9EF;">SUM</span><span style="color:#F8F8F2;">(max_total_g), </span><span style="color:#AE81FF;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#AE81FF;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#66D9EF;">SUM</span><span style="color:#F8F8F2;">(max_total_g)) </span><span style="color:#F92672;">*</span><span style="color:#AE81FF;"> 100</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#AE81FF;">                2</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">||</span><span style="color:#E6DB74;"> &#39;%&#39;</span></span>
<span class="line"><span style="color:#F92672;">         ELSE</span></span>
<span class="line"><span style="color:#E6DB74;">          &#39;-&#39;</span></span>
<span class="line"><span style="color:#F92672;">       END</span><span style="color:#F8F8F2;">) </span><span style="color:#F92672;">AS</span><span style="color:#F8F8F2;"> max_remained_rate</span></span>
<span class="line"><span style="color:#F92672;">  FROM</span><span style="color:#F8F8F2;"> w1</span></span>
<span class="line"><span style="color:#F92672;"> GROUP BY</span><span style="color:#AE81FF;"> w1</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">tbs</span><span style="color:#F8F8F2;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="查看数据文件" tabindex="-1"><a class="header-anchor" href="#查看数据文件"><span>查看数据文件</span></a></h2><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="background-color:#272822;color:#F8F8F2;"><pre class="shiki monokai vp-code"><code><span class="line"><span style="color:#F92672;">SELECT</span><span style="color:#AE81FF;"> t</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">file_name</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#AE81FF;">       t</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">file_id</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#AE81FF;">       t</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">tablespace_name</span><span style="color:#F8F8F2;"> tbs,</span></span>
<span class="line"><span style="color:#AE81FF;">       t</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">bytes</span><span style="color:#F92672;"> /</span><span style="color:#AE81FF;"> 1024</span><span style="color:#F92672;"> /</span><span style="color:#AE81FF;"> 1024</span><span style="color:#F92672;"> /</span><span style="color:#AE81FF;"> 1024</span><span style="color:#F8F8F2;"> size_g,</span></span>
<span class="line"><span style="color:#AE81FF;">       t</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">maxbytes</span><span style="color:#F92672;"> /</span><span style="color:#AE81FF;"> 1024</span><span style="color:#F92672;"> /</span><span style="color:#AE81FF;"> 1024</span><span style="color:#F92672;"> /</span><span style="color:#AE81FF;"> 1024</span><span style="color:#F92672;"> AS</span><span style="color:#F8F8F2;"> m_size_g,</span></span>
<span class="line"><span style="color:#AE81FF;">       t</span><span style="color:#F8F8F2;">.</span><span style="color:#AE81FF;">autoextensible</span><span style="color:#F92672;"> auto</span></span>
<span class="line"><span style="color:#F92672;">  FROM</span><span style="color:#F8F8F2;"> dba_data_files t;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="添加数据文件" tabindex="-1"><a class="header-anchor" href="#添加数据文件"><span>添加数据文件</span></a></h2><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="background-color:#272822;color:#F8F8F2;"><pre class="shiki monokai vp-code"><code><span class="line"><span style="color:#88846F;">--非RAC（路径最前面不带+）</span></span>
<span class="line"><span style="color:#F92672;">alter</span><span style="color:#F92672;"> tablespace</span><span style="color:#F92672;"> system</span><span style="color:#F92672;"> add</span><span style="color:#F8F8F2;"> datafile </span><span style="color:#E6DB74;">&#39;/u01/app/oracle/oradata/testdb/datafile/system02.dbf&#39;</span><span style="color:#F92672;"> size</span><span style="color:#F8F8F2;"> 10M autoextend </span><span style="color:#F92672;">on</span><span style="color:#F92672;"> next</span><span style="color:#F8F8F2;"> 1M maxsize </span><span style="color:#F92672;">unlimited</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">--RAC（路径最前面带+）</span></span>
<span class="line"><span style="color:#F92672;">alter</span><span style="color:#F92672;"> tablespace</span><span style="color:#F92672;"> system</span><span style="color:#F92672;"> add</span><span style="color:#F8F8F2;"> datafile </span><span style="color:#F92672;">size</span><span style="color:#F8F8F2;"> 10M autoextend </span><span style="color:#F92672;">on</span><span style="color:#F92672;"> next</span><span style="color:#F8F8F2;"> 1M maxsize </span><span style="color:#F92672;">unlimited</span><span style="color:#F8F8F2;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,7)]))}const r=a(o,[["render",F]]),y=JSON.parse('{"path":"/databases/oracle/TableSpace.html","title":"表空间","lang":"zh-CN","frontmatter":{},"git":{},"readingTime":{"minutes":0.18,"words":54},"filePathRelative":"databases/oracle/TableSpace.md"}');export{r as comp,y as data};

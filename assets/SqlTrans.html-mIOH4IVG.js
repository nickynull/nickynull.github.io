import{c as h,o as d,b as u,F as P,i as D,w as v,f as b,v as O,t as k,d as V}from"./app-DvBCiDO4.js";import{_}from"./plugin-vue_export-helper-DlAUqK2U.js";const $=",",g="->",S='"',R=`(.*)${g}(.*)`,q="(^\\d{4}/\\d{1,2}/\\d{1,2}\\s?(\\d{1,2}:\\d{1,2}:\\d{1,2})?$)",T="'",C="null",F="TO_DATE('{0}', 'yyyy/mm/dd hh24:mi:ss')";function L(e){let t=g,a=null,o="",s={};if(!e||!e.trim())throw"未输入需要转换的SQL";var r=e.indexOf(t);if(r!=-1){if(a=e.substr(0,r),o=e.substr(r+t.length),o=o.split(`
`)[0],o.Length<3)throw"SQL参数异常";let l=o.substr(0,2);s=W(o,l)}let n=j(a,s);if(n==null)throw"没有可转换的SQL";return n}function W(e,t){const a={},o=new RegExp(`${$}(?=${t})`),s=e.split(o);for(let r=0;r<s.length;r++){const n=s[r];if(n){const l=n.match(R);if(!l)throw"参数键值匹配异常";const c=l[1],i=N(l[2]);a[c]=i}}return a}function N(e){let t=e.trim();if(t=="")t=C;else if(t.match(q))t=F.replace("{0}",e);else{const a=new RegExp(`(^${S})(.*)(${S}$)`);t=t.replace(a,`${T}$2${T}`)}return t}function j(e,t){let a=e;for(const o in t){const s=new RegExp(`${o}\\b`);a=a.replace(s,t[o])}return a}function Q(e){return L(e)}function A(e){const t=new RegExp("\\D*(\\d*):\\((\\S*),\\s*(.*)\\)"),o=e.split(`
`);let s=[];s.push(`DECODE(解析字段
`);for(let n=0;n<o.length;n++){let l=o[n].trim();if(l!=""&&t.test(l)){var r=l.replace(t,",$1,'$3' ");s.push(r)}}return s.push(")"),s.join("")}function B(e){return A(e)}function y(e,t){if(!e||e.trim()=="")throw"没有需要转换的内容";let a=[],o=[],s=[],r=-1;const n=e.split(/,\s*\n\s*/),l=new RegExp('\\[Label\\("([^\\]]+)"\\)\\]+?\\s*(.+)',"m"),c=new RegExp("(\\[.*\\])*\\s*(\\S+)\\s*(=\\s*(\\d+))?");for(let i=0;i<n.length;i++){const f=n[i].replace(/\n/mg," ").match(l);if(f){const E=f[1],x=f[2].match(c);if(x)if(a[i]=E,o[i]=x[2],s[i]=x[4],!s[i]||s[i].trim()==""){const w=r+1;s[i]=w.toString(),r=w}else r=Number(s[i])}}t(n.length,a,o,s)}const p={isEmpty(e){return e==null||e==""},isEmptyOrWhiteSpace(e){return e==null||e.trim()==""},copyToClipboard(e){window.$jtools.clipboardApi.writeText(e)}};function I(e){var t=[];return y(e,(a,o,s,r)=>{for(let l=0;l<a;l++){const c=o[l],i=s[l],m=r[l];if(!p.isEmptyOrWhiteSpace(c)&&!p.isEmptyOrWhiteSpace(i)&&!p.isEmptyOrWhiteSpace(m)){var n=`${m}:(${i}, ${c})
`;t.push(n)}}}),t.join("")}function M(e){var t=[];return t.push("DECODE(字段"),y(e,(a,o,s,r)=>{for(let l=0;l<a;l++){const c=o[l],i=s[l],m=r[l];if(!p.isEmptyOrWhiteSpace(c)&&!p.isEmptyOrWhiteSpace(i)&&!p.isEmptyOrWhiteSpace(m)){var n=`
,${m},'${c}' `;t.push(n)}}t.push(`
)`)}),t.join("")}const U={data(){return{value:"2",options:[{value:"2",label:"枚举转描述"},{value:"1",label:"枚举描述Decode"},{value:"3",label:"枚举转Decode"}],transFun:{0:Q,1:B,2:I,3:M},rawTxt:"",transTxt:""}},methods:{showSuccess(e){window.$alert(e)},showError(e){window.$alert(e)},errorProceess(e){try{e()}catch(t){this.showError(`产生异常：${t}`)}},trans(){this.value&&this.transFun[this.value]&&this.errorProceess(()=>{this.transTxt=this.transFun[this.value](this.rawTxt),this.showSuccess("转换完毕")})},copy(){window.$copy(this.transTxt)},clearOutput(){this.transTxt="",this.showSuccess("清空完毕")},clear(){this.rawTxt="",this.transTxt="",this.showSuccess("清空完毕")}}},z={class:"jm-block"},J={class:"line-block"},K={class:"line-block"},G=["value","id"],H=["for"],X={class:"line-block"};function Y(e,t,a,o,s,r){return d(),h("div",z,[u("div",J,[u("button",{onClick:t[0]||(t[0]=(...n)=>r.trans&&r.trans(...n))},"运行"),u("button",{onClick:t[1]||(t[1]=(...n)=>r.copy&&r.copy(...n))},"复制"),u("button",{onClick:t[2]||(t[2]=(...n)=>r.clearOutput&&r.clearOutput(...n))},"清空输出"),u("button",{onClick:t[3]||(t[3]=(...n)=>r.clear&&r.clear(...n))},"清空")]),u("div",K,[(d(!0),h(P,null,D(s.options,n=>(d(),h("div",null,[v(u("input",{type:"radio","onUpdate:modelValue":t[4]||(t[4]=l=>s.value=l),value:n.value,id:n.value},null,8,G),[[O,s.value]]),u("label",{for:n.value},k(n.label),9,H)]))),256))]),u("div",X,[v(u("textarea",{"onUpdate:modelValue":t[5]||(t[5]=n=>s.rawTxt=n),class:"text line-huge",placeholder:"输入"},null,512),[[b,s.rawTxt]]),v(u("textarea",{"onUpdate:modelValue":t[6]||(t[6]=n=>s.transTxt=n),class:"text line-huge",placeholder:"输出",readonly:""},null,512),[[b,s.transTxt]])])])}const Z=_(U,[["render",Y]]),rt={__name:"SqlTrans.html",setup(e){return(t,a)=>(d(),h("div",null,[a[0]||(a[0]=u("h1",{id:"枚举值转换",tabindex:"-1"},[u("a",{class:"header-anchor",href:"#枚举值转换"},[u("span",null,"枚举值转换")])],-1)),V(Z)]))}},lt=JSON.parse('{"path":"/tools/SqlTrans.html","title":"枚举值转换","lang":"zh-CN","frontmatter":{},"git":{},"readingTime":{"minutes":0.05,"words":14},"filePathRelative":"tools/SqlTrans.md"}');export{rt as comp,lt as data};

import{_ as n,o as s,c as a,j as p}from"./app-06tck_FE.js";const t={},e=p(`<h1 id="表空间" tabindex="-1"><a class="header-anchor" href="#表空间" aria-hidden="true">#</a> 表空间</h1><h2 id="查看表空间使用情况" tabindex="-1"><a class="header-anchor" href="#查看表空间使用情况" aria-hidden="true">#</a> 查看表空间使用情况</h2><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">WITH</span> w1 <span class="token keyword">AS</span>
 <span class="token punctuation">(</span><span class="token keyword">SELECT</span> b<span class="token punctuation">.</span>file_id<span class="token punctuation">,</span>
         b<span class="token punctuation">.</span>tablespace_name tbs<span class="token punctuation">,</span>
         b<span class="token punctuation">.</span>file_name NAME<span class="token punctuation">,</span>
         <span class="token function">round</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>bytes <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> total_g<span class="token punctuation">,</span>
         <span class="token comment">--round(decode(b.maxbytes,0,b.bytes,b.maxbytes) / 1024 / 1024 / 1024, 2) AS max_total_g,</span>
         <span class="token function">round</span><span class="token punctuation">(</span>greatest<span class="token punctuation">(</span>b<span class="token punctuation">.</span>maxbytes<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>b<span class="token punctuation">.</span>bytes<span class="token punctuation">,</span>b<span class="token punctuation">.</span>maxbytes<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> max_total_g<span class="token punctuation">,</span>
         <span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>bytes <span class="token operator">-</span>
               decode<span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span>nvl<span class="token punctuation">(</span>a<span class="token punctuation">.</span>bytes<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>nvl<span class="token punctuation">(</span>a<span class="token punctuation">.</span>bytes<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">,</span>
               <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> used_g<span class="token punctuation">,</span>
         <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span>nvl<span class="token punctuation">(</span>a<span class="token punctuation">.</span>bytes<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> remained_g
    <span class="token keyword">FROM</span> dba_free_space a<span class="token punctuation">,</span> dba_data_files b
   <span class="token keyword">WHERE</span> a<span class="token punctuation">.</span>file_id<span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span> <span class="token operator">=</span> b<span class="token punctuation">.</span>file_id
   <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> b<span class="token punctuation">.</span>file_id<span class="token punctuation">,</span> b<span class="token punctuation">.</span>tablespace_name<span class="token punctuation">,</span> b<span class="token punctuation">.</span>file_name<span class="token punctuation">,</span> b<span class="token punctuation">.</span>bytes<span class="token punctuation">,</span> b<span class="token punctuation">.</span>maxbytes<span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> w1<span class="token punctuation">.</span>tbs<span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>total_g<span class="token punctuation">)</span> <span class="token keyword">AS</span> total_g<span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>max_total_g<span class="token punctuation">)</span> <span class="token keyword">AS</span> max_total_g<span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>used_g<span class="token punctuation">)</span> <span class="token keyword">AS</span> used_g<span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>remained_g<span class="token punctuation">)</span> <span class="token keyword">AS</span> remained_g<span class="token punctuation">,</span>
       <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span>used_g<span class="token punctuation">)</span> <span class="token operator">/</span> decode<span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span>total_g<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>total_g<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span>
             <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">&#39;%&#39;</span> <span class="token keyword">AS</span> used_rate<span class="token punctuation">,</span>
       <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span>remained_g<span class="token punctuation">)</span> <span class="token operator">/</span> decode<span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span>total_g<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>total_g<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span>
             <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">&#39;%&#39;</span> <span class="token keyword">AS</span> remained_rate<span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token keyword">CASE</span>
         <span class="token keyword">WHEN</span> <span class="token function">SUM</span><span class="token punctuation">(</span>max_total_g<span class="token punctuation">)</span> <span class="token operator">&lt;&gt;</span> <span class="token number">0</span> <span class="token keyword">THEN</span>
          <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span>used_g<span class="token punctuation">)</span> <span class="token operator">/</span>
                decode<span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span>max_total_g<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>max_total_g<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span>
                <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">&#39;%&#39;</span>
         <span class="token keyword">ELSE</span>
          <span class="token string">&#39;-&#39;</span>
       <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> max_used_rate<span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token keyword">CASE</span>
         <span class="token keyword">WHEN</span> <span class="token function">SUM</span><span class="token punctuation">(</span>max_total_g<span class="token punctuation">)</span> <span class="token operator">&lt;&gt;</span> <span class="token number">0</span> <span class="token keyword">THEN</span>
          <span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span>max_total_g<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">SUM</span><span class="token punctuation">(</span>used_g<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span>
                decode<span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span>max_total_g<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>max_total_g<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span>
                <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">&#39;%&#39;</span>
         <span class="token keyword">ELSE</span>
          <span class="token string">&#39;-&#39;</span>
       <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> max_remained_rate
  <span class="token keyword">FROM</span> w1
 <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> w1<span class="token punctuation">.</span>tbs<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="查看数据文件" tabindex="-1"><a class="header-anchor" href="#查看数据文件" aria-hidden="true">#</a> 查看数据文件</h2><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> t<span class="token punctuation">.</span>file_name<span class="token punctuation">,</span>
       t<span class="token punctuation">.</span>file_id<span class="token punctuation">,</span>
       t<span class="token punctuation">.</span>tablespace_name tbs<span class="token punctuation">,</span>
       t<span class="token punctuation">.</span>bytes <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span> size_g<span class="token punctuation">,</span>
       t<span class="token punctuation">.</span>maxbytes <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token keyword">AS</span> m_size_g<span class="token punctuation">,</span>
       t<span class="token punctuation">.</span>autoextensible auto
  <span class="token keyword">FROM</span> dba_data_files t<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="添加数据文件" tabindex="-1"><a class="header-anchor" href="#添加数据文件" aria-hidden="true">#</a> 添加数据文件</h2><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">--非RAC（路径最前面不带+）</span>
<span class="token keyword">alter</span> <span class="token keyword">tablespace</span> system <span class="token keyword">add</span> datafile <span class="token string">&#39;/u01/app/oracle/oradata/testdb/datafile/system02.dbf&#39;</span> size <span class="token number">10</span>M autoextend <span class="token keyword">on</span> <span class="token keyword">next</span> <span class="token number">1</span>M maxsize unlimited<span class="token punctuation">;</span>

<span class="token comment">--RAC（路径最前面带+）</span>
<span class="token keyword">alter</span> <span class="token keyword">tablespace</span> system <span class="token keyword">add</span> datafile size <span class="token number">10</span>M autoextend <span class="token keyword">on</span> <span class="token keyword">next</span> <span class="token number">1</span>M maxsize unlimited<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,7),o=[e];function c(l,u){return s(),a("div",null,o)}const k=n(t,[["render",c],["__file","TableSpace.html.vue"]]);export{k as default};
